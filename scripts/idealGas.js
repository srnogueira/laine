/*
  Properties for selected ideal gases
  Reference: NASA Glenn
*/

let nasaMW= new Map(); // Molecular mass
let nasa1K= new Map(); // 200 - 1K
let nasa6K= new Map(); // 1K - 6K

//N2
nasa1K.set("N2",[2.210371497E+04,-3.818461820E+02,6.082738360E+00,
                -8.530914410E-03,1.384646189E-05,-9.625793620E-09,
                2.519705809E-12,7.108460860E+02,-1.076003744E+01]);
nasa6K.set("N2",[5.877124060E+05,-2.239249073E+03,6.066949220E+00,
		  -6.139685500E-04,1.491806679E-07,-1.923105485E-11,
		  1.061954386E-15,1.283210415E+04,-1.586640027E+01]);
nasaMW.set("N2",28.01340);

//O2
nasa1K.set("O2",[-3.425563420E+04,4.847000970E+02,1.119010961E+00,
                4.293889240E-03,-6.836300520E-07,-2.023372700E-09,
                  1.039040018E-12,-3.391454870E+03,1.849699470E+01]);
nasa6K.set("O2",[-1.037939022E+06,2.344830282E+03,1.819732036E+00,
		 1.267847582E-03,-2.188067988E-07,2.053719572E-11,
		 -8.193467050E-16,-1.689010929E+04,1.738716506E+01,]);
nasaMW.set("O2",31.99880);

//CO2
nasa1K.set("CO2",[4.943650540E+04,-6.264116010E+02,5.301725240E+00,
		  2.503813816E-03,-2.127308728E-07,-7.689988780E-10,
		  2.849677801E-13,-4.528198460E+04,-7.048279440E+00]);
nasa6K.set("CO2",[1.176962419E+05,-1.788791477E+03,8.291523190E+00,
		   -9.223156780E-05,4.863676880E-09,-1.891053312E-12,
		   6.330036590E-16,-3.908350590E+04,-2.652669281E+01]);
nasaMW.set("CO2",44.00950);

//CO
nasa1K.set("CO",[1.489045326E+04,-2.922285939E+02,5.724527170E+00,
		  -8.176235030E-03,1.456903469E-05,-1.087746302E-08,
		  3.027941827E-12,-1.303131878E+04,-7.859241350E+00]);
nasa6K.set("CO",[4.619197250E+05,-1.944704863E+03,5.916714180E+00,
		  -5.664282830E-04,1.398814540E-07,-1.787680361E-11,
		  9.620935570E-16,-2.466261084E+03,-1.387413108E+01]);
nasaMW.set("CO",28.01010);

//H2O
nasa1K.set("H2O",[-3.947960830E+04,5.755731020E+02,9.317826530E-01,
		   7.222712860E-03,-7.342557370E-06,4.955043490E-09,
		   -1.336933246E-12,-3.303974310E+04,1.724205775E+01]);
nasa6K.set("H2O",[1.034972096E+06,-2.412698562E+03,4.646110780E+00,
		   2.291998307E-03,-6.836830480E-07,9.426468930E-11,
		   -4.822380530E-15,-1.384286509E+04,-7.978148510E+00]);
nasaMW.set("H2O",18.01528);
	    
//OH
nasa1K.set("OH",[-1.998858990E+03,9.300136160E+01,3.050854229E+00,
		  1.529529288E-03,-3.157890998E-06,3.315446180E-09,
		  -1.138762683E-12,2.991214235E+03,4.674110790E+00]);
nasa6K.set("OH",[1.017393379E+06,-2.509957276E+03,5.116547860E+00,
		  1.305299930E-04,-8.284322260E-08,2.006475941E-11,
		  -1.556993656E-15,2.019640206E+04,-1.101282337E+01]);
nasaMW.set("OH",17.00734);

//H2
nasa1K.set("H2",[4.078323210E+04,-8.009186040E+02,8.214702010E+00,
		  -1.269714457E-02,1.753605076E-05,-1.202860270E-08,
		  3.368093490E-12,2.682484665E+03,-3.043788844E+01]);
nasa6K.set("H2",[5.608128010E+05,-8.371504740E+02,2.975364532E+00,
		  1.252249124E-03,-3.740716190E-07,5.936625200E-11,
		  -3.606994100E-15,5.339824410E+03,-2.202774769E+00]);
nasaMW.set("H2",2.01588);

//H
nasa1K.set("H",[0.000000000E+00,0.000000000E+00,2.500000000E+00,
		 0.000000000E+00,0.000000000E+00,0.000000000E+00,
		 0.000000000E+00,2.547370801E+04,-4.466828530E-01]);
nasa6K.set("H",[6.078774250E+01,-1.819354417E-01,2.500211817E+00,
		 -1.226512864E-07,3.732876330E-11,-5.687744560E-15,
		 3.410210197E-19,2.547486398E+04,-4.481917770E-01]);
nasaMW.set("H",1.00794);

//NO
nasa1K.set("NO",[-1.143916503E+04,1.536467592E+02,3.431468730E+00,
		  -2.668592368E-03,8.481399120E-06,-7.685111050E-09,
		  2.386797655E-12,9.098214410E+03,6.728725490E+00]);
nasa6K.set("NO",[2.239018716E+05,-1.289651623E+03,5.433936030E+00,
		  -3.656034900E-04,9.880966450E-08,-1.416076856E-11,
		  9.380184620E-16,1.750317656E+04,-8.501669090E+00]);
nasaMW.set("NO",30.00610);

//NO2
nasa1K.set("NO2",[-5.642038780E+04,9.633085720E+02,-2.434510974E+00,
		   1.927760886E-02,-1.874559328E-05,9.145497730E-09,
		   -1.777647635E-12,-1.547925037E+03,4.067851210E+01]);
nasa6K.set("NO2",[7.213001570E+05,-3.832615200E+03,1.113963285E+01,
		   -2.238062246E-03,6.547723430E-07,-7.611335900E-11,
		   3.328361050E-15,2.502497403E+04,-4.305130040E+01]);
nasaMW.set("NO2",46.00550);

//N
nasa1K.set("N",[0.000000000E+00,0.000000000E+00,2.500000000E+00,
		 0.000000000E+00,0.000000000E+00,0.000000000E+00,
		 0.000000000E+00,5.610463780E+04,4.193905036E+00]);
nasa6K.set("N",[8.876501380E+04,-1.071231500E+02,2.362188287E+00,
		 2.916720081E-04,-1.729515100E-07,4.012657880E-11,
		 -2.677227571E-15,5.697351330E+04,4.865231506E+00]);
nasaMW.set("N",14.00670);

//O
nasa1K.set("O",[-7.953611300E+03,1.607177787E+02,1.966226438E+00,
		1.013670310E-03,-1.110415423E-06,6.517507500E-10,
		-1.584779251E-13,2.840362437E+04,8.404241820E+00]);
nasa6K.set("O",[2.619020262E+05,-7.298722030E+02,3.317177270E+00,
		-4.281334360E-04,1.036104594E-07,-9.438304330E-12,
		2.725038297E-16,3.392428060E+04,-6.679585350E-01]);
nasaMW.set("O",15.99940);

//CH4

nasaMW.set("CH4",16.0424600);
nasa1K.set("CH4",[-1.766850998E+05,2.786181020E+03,-1.202577850E+01,
		  3.917619290E-02,-3.619054430E-05,2.026853043E-08,
		  -4.976705490E-12,-2.331314360E+04,8.904322750E+01]);
nasa6K.set("CH4",[3.730042760E+06,-1.383501485E+04,2.049107091E+01,
		  -1.961974759E-03,4.727313040E-07,-3.728814690E-11,
		  1.623737207E-15,7.532066910E+04,-1.219124889E+02]);

/* 
   Thermodynamic functions
*/

// g/mol
function nasa_mw(fluid){
    return nasaMW.get(fluid);
}

// J/mol ?
function nasa_h(fluid,T){ 
    // Constants
    let R=8.314510;
    let a;
    if (T <= 1000){
	a=nasa1K.get(fluid);
    }
    else{
	a=nasa6K.get(fluid);
    }

    // Property
    let ans;
    ans=-a[0]/(T*T)+a[1]*Math.log(T)/T+a[2]+a[3]*T/2+a[4]*(T*T)/3+a[5]*(T*T*T)/4+a[6]*(T*T*T*T)/5+a[7]/T;
    ans*=R*T;
    return ans;
}

// J/mol
function nasa_u(fluid,T){
    // Constants
    let R=8.314510;
    let h=nasa_h(fluid,T);

    return h-R*T;
}

// J/mol-K
function nasa_s(fluid,T,P){
    // Constants
    let R=8.314510;
    let Pref=1E5;
    let a;
    if (T <= 1000){
	a=nasa1K.get(fluid);
    }
    else{
	a=nasa6K.get(fluid);
    }

    // Property
    let ans;
    ans=-a[0]/(T*T)/2-a[1]/T+a[2]*Math.log(T)+a[3]*T+a[4]*(T*T)/2+a[5]*(T*T*T)/3+a[6]*(T*T*T*T)/4+a[8]-Math.log(P/Pref);
    ans*=R;
    return ans;
}

// J/mol
function nasa_g(fluid,T,P){
    // Constants
    let R=8.314510;
    let h=nasa_h(fluid,T);
    let s=nasa_s(fluid,T,P);

    return h-T*s;
}


// J/mol
function nasa_f(fluid,T,P){
    // Constants
    let R=8.314510;
    let u=nasa_u(fluid,T);
    let s=nasa_s(fluid,T,P);

    return u-T*s;
}

// J/mol
function nasa_cp(fluid,T){
    // Constants
    let R=8.314510;
    let a;
    if (T <= 1000){
	a=nasa1K.get(fluid);
    }
    else{
	a=nasa6K.get(fluid);
    }

    // Property
    let ans;
    ans=a[0]/(T*T)+a[1]/T+a[2]+a[3]*T+a[4]*T*T+a[5]*T*T*T+a[6]*T*T*T*T;
    ans*=R;
    return ans;
}

// J/mol
function nasa_cv(fluid,T){
    let R=8.314510;
    let cp=nasa_cp(fluid,T);
    return cp-R;
}

/*
  Function wrappers
*/
// Possibilities
// T - h,u,cp,cv
// s - (T,P) or (X,P)
// P - (s,T) or (s,X)
